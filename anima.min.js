(function(){function t(){this.handlers={}}function n(n,i,r,a,e){t.call(this),this.item=n,this.translate=i.translate,this.rotate=i.rotate,this.scale=i.scale,this.start=null,this.duration=r||i.duration||500,this.delay=e||i.delay||0,this.easing=s[a]||s[i.easing]||s.linear}function i(i,r,a,e,s){t.call(this),this.item=i,this.animations=r.map(function(t){return new n(i,t.transform||{translate:t.translate,rotate:t.rotate,scale:t.scale},t.duration||a,t.easing||e,t.delay||s)}),this.start=null,this.delay=0,this.duration=Math.max.apply(null,this.animations.map(function(t){return t.duration+t.delay}))}function r(t){this.items=[],this._nextTick=null,t&&this.init()}function a(n){t.call(this),this.dom=n,this.animations=[],this.state={},this.transform={},this._dirty=!1,this.init()}var e=window.anima={};e.init=function(){return new r(!0)},!function(){for(var t=["webkit","Moz","O","ms"],n=-1;!window.requestAnimationFrame&&++n<t.length;){var i=t[n].toLowerCase();window.requestAnimationFrame=window[i+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"]}window.transformProperty=function(){var n=document.createElement("div").style;return n.transform===void 0?t.filter(function(t){return n[t+"Transform"]!==void 0})[0]+"Transform":"transform"}()}();var s=function(){var t={quad:function(t){return Math.pow(t,2)},cubic:function(t){return Math.pow(t,2)},quart:function(t){return Math.pow(t,4)},quint:function(t){return Math.pow(t,5)},expo:function(t){return Math.pow(t,6)},sine:function(t){return 1-Math.cos(t*Math.PI/2)},circ:function(t){return 1-Math.sqrt(1-t*t)},back:function(t){return t*t*(3*t-2)}},n={linear:function(t){return t}};return Object.keys(t).forEach(function(i){var r=t[i];n["ease-in-"+i]=r,n["ease-out-"+i]=function(t){return 1-r(1-t)},n["ease-in-out-"+i]=function(t){return.5>t?r(2*t)/2:1-r(-2*t+2)/2}}),n}();t.prototype.on=function(t,n){return(this.handlers[t]=this.handlers[t]||[]).push(n),this},t.prototype.off=function(t,n){var i=this.handlers[t];return n?i.splice(i.indexOf(n),1):i=[],this},t.prototype.emit=function(t){var n=Array.prototype.slice.call(arguments,1),i=this.handlers[t];if(i)for(var r=i.length,a=0;r>a;++a)i[a].apply(this,n);return this},n.prototype=new t,n.prototype.constructor=n,n.prototype.init=function(t){if(null===this.start){this.start=t;var n=this.item.state;this.initial={translate:n.translate.slice(),rotate:n.rotate.slice(),scale:n.scale.slice()},this.emit("start")}},n.prototype.animate=function(){return this.item.animate.apply(this.item,arguments)},n.prototype.run=function(t){if(!(t-this.start<this.delay)){var n=(t-this.delay-this.start)/this.duration;0>n&&(n=0),n=this.easing(n),this.transform(n)}},n.prototype.set=function(t,n,i,r){this[t]&&this[t].length&&(this[t][0]&&(n[t][0]=i[t][0]+this[t][0]*r),this[t][1]&&(n[t][1]=i[t][1]+this[t][1]*r),this[t][2]&&(n[t][2]=i[t][2]+this[t][2]*r))},n.prototype.transform=function(t){var n=this.item.state,i=this.initial;this.set("translate",n,i,t),this.set("rotate",n,i,t),this.set("scale",n,i,t)},n.prototype.end=function(t){!t&&this.transform(1),this.emit("end")},i.prototype=new t,i.prototype.constructor=i,i.prototype.init=function(t){if(null===this.start){this.start=t;for(var n=0,i=this.animations.length;i>n;++n)this.animations[n].init(t);this.emit("start")}},i.prototype.animate=function(){return this.item.animate.apply(this.item,arguments)},i.prototype.run=function(t){for(var n=0;this.animations.length>n;++n){var i=this.animations[n];t>=i.start+i.delay+i.duration?(this.animations.splice(n--,1),i.end()):i.run(t)}},i.prototype.end=function(t){for(var n=0,i=this.animations.length;i>n;++n)this.animations[n].end(t);this.emit("end")},r.prototype.init=function(){function t(i){n.update(i),n._nextTick=requestAnimationFrame(t)}var n=this;this._nextTick=requestAnimationFrame(t)},r.prototype.stop=function(){this._nextTick&&cancelAnimationFrame(this._nextTick)},r.prototype.add=function(t){var n=new a(t);return this.items.push(n),n},r.prototype.update=function(t){for(var n=0,i=this.items.length;i>n;n++)this.items[n].update(t)},r.prototype.on=function(t,n){window.addEventListener(t,n,!0)};var o=Math.PI/180,h={id:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},multiply:function u(t,n){var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];return i[0]=t[0]*n[0]+t[1]*n[4]+t[2]*n[8],i[1]=t[0]*n[1]+t[1]*n[5]+t[2]*n[9],i[2]=t[0]*n[2]+t[1]*n[6]+t[2]*n[10],i[4]=t[4]*n[0]+t[5]*n[4]+t[6]*n[8],i[5]=t[4]*n[1]+t[5]*n[5]+t[6]*n[9],i[6]=t[4]*n[2]+t[5]*n[6]+t[6]*n[10],i[8]=t[8]*n[0]+t[9]*n[4]+t[10]*n[8],i[9]=t[8]*n[1]+t[9]*n[5]+t[10]*n[9],i[10]=t[8]*n[2]+t[9]*n[6]+t[10]*n[10],i[12]=t[12]*n[0]+t[13]*n[4]+t[14]*n[8]+n[12],i[13]=t[12]*n[1]+t[13]*n[5]+t[14]*n[9]+n[13],i[14]=t[12]*n[2]+t[13]*n[6]+t[14]*n[10]+n[14],2>=arguments.length?i:u.apply(null,[i].concat(Array.prototype.slice.call(arguments,2)))},translate:function(t,n,i){return t||n||i?(t||(t=0),n||(n=0),i||(i=0),[1,0,0,0,0,1,0,0,0,0,1,0,t,n,i,1]):h.id()},translateX:function(t){return this.translate(t,0,0)},translateY:function(t){return this.translate(0,t,0)},translateZ:function(t){return this.translate(0,0,t)},scale:function(t,n,i){return t||n||i?(t||(t=1),n||(n=1),i||(i=1),[t,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1]):h.id()},scaleX:function(t){return this.scale(t,0,0)},scaleY:function(t){return this.scale(0,t,0)},scaleZ:function(t){return this.scale(0,0,t)},rotate:function(t,n,i){if(!(t||n||i))return h.id();t||(t=0),n||(n=0),i||(i=0),t*=o,n*=o,i*=o;var r=Math.sin(t),a=Math.cos(t),e=Math.sin(n),s=Math.cos(n),u=Math.sin(i),c=Math.cos(i);return[s*c,a*u+r*e*c,r*u-a*e*c,0,-s*u,a*c-r*e*u,r*c+a*e*u,0,e,-r*s,a*s,0,0,0,0,1]},rotateX:function(t){t*=o;var n=Math.sin(t),i=Math.cos(t);return[1,0,0,0,0,i,n,0,0,-n,i,0,0,0,0,1]},rotateY:function(t){t*=o;var n=Math.sin(t),i=Math.cos(t);return[i,0,-n,0,0,1,0,0,n,0,i,0,0,0,0,1]},rotateZ:function(t){t*=o;var n=Math.sin(t),i=Math.cos(t);return[i,n,0,0,-n,i,0,0,0,0,1,0,0,0,0,1]},rotate3d:function(t,n,i,r){r*=o;var a=Math.sin(r),e=Math.cos(r),s=Math.sqrt(t*t+n*n+i*i);0===s?(t=0,n=0,i=1):1!==s&&(t/=s,n/=s,i/=s);var h=t*t,u=n*n,c=i*i,l=1-e;return[h+(1-h)*e,t*n*l+i*a,t*i*l-n*a,0,t*n*l-i*a,u+(1-u)*e,n*i*l+t*a,0,t*i*l+n*a,n*i*l-t*a,c+(1-c)*e,0,0,0,0,1]},skew:function(t,n){return t*=o,n*=o,[1,Math.tan(n),0,0,Math.tan(t),1,0,0,0,0,1,0,0,0,0,1]},skewX:function(t){return this.skew(t,0)},skewY:function(t){return this.skew(0,t)},perspective:function(t){return t=-1/t,[1,0,0,0,0,1,0,0,0,0,1,t,0,0,0,1]},toString:function(t){for(var n=0,i=t.length;i>n;++n)1e-6>Math.abs(t[n])&&(t[n]=0);return"matrix3d("+t.join()+")"},toTestString:function(t){function n(t){return t.toFixed(6)}function i(t){return 0===t[2]&&0===t[3]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[14]&&1===t[15]}function r(t,n){return-1!==[0,1,4,5,12,13].indexOf(n)}return i(t)?"matrix("+t.filter(r).map(n).join(", ")+")":"matrix3d("+t.map(n).join(", ")+")"}};a.prototype=new t,a.prototype.constructor=a,a.prototype.init=function(){this.state={translate:[0,0,0],rotate:[0,0,0],scale:[1,1,1]},this.zero("transform"),this.on("transform",function(t,n,i){this.transform.translate=t,this.transform.rotate=n,this.transform.scale=i,this._dirty=!0})},a.prototype.update=function(t){this.animation(t),this.style()},a.prototype.style=function(){var t=this.state;this.dom.style[transformProperty]=h.toString(h.multiply(h.translate.apply(null,t.translate),h.rotate.apply(null,t.rotate),h.scale.apply(null,t.scale)))},a.prototype.add=function(t,n){this.state[t][0]+=n[0],this.state[t][1]+=n[1],this.state[t][2]+=n[2]},a.prototype.translate=function(t){this.add("translate",t)},a.prototype.rotate=function(t){this.add("rotate",t)},a.prototype.scale=function(t){this.add("scale",t)},a.prototype.clear=function(){this.zero("state")},a.prototype.animate=function(t,r,a,e){var s=Array.isArray(t)?i:n,o=new s(this,t,r,a,e);return this.animations.push(o),this.zero("transform"),o},a.prototype.animation=function(t){if(0===this.animations.length&&this._dirty&&(this.animate(this.transform),this._dirty=!1),0!==this.animations.length)for(;0!==this.animations.length;){var n=this.animations[0];n.init(t);{if(!(t>=n.start+n.delay+n.duration)){n.run(t);break}this.animations.shift(),n.end()}}},a.prototype.zero=function(t){this[t].translate=[0,0,0],this[t].rotate=[0,0,0],this[t].scale=[0,0,0]},a.prototype.reset=function(){if(0!==this.animations.length){for(var t=0,n=this.animations.length;n>t;t++){var i=this.animations[t];i.end(!0)}this.animations=[],this.zero("transform")}}})();
//@ sourceMappingURL=anima.min.js.map